<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="global.css">
    <link rel="stylesheet" href="./index.css">
    <script src="./index.js"></script>
    <title>Document</title>
</head>

<body>
    <script>
        function loadDoc(callback) {
            const xhttp = new XMLHttpRequest();
            xhttp.onload = function () {
                if (this.status === 200) {
                    const responseData = JSON.parse(this.responseText);
                    callback(null, responseData);
                } else {
                    const error = new Error(`Error loading data. Status: ${this.status}`);
                    callback(error, null);
                }
            };
            xhttp.open("GET", "json.json", true);
            xhttp.send();
        }
        function loadInfoDoc(callback) {
            const xhttp = new XMLHttpRequest();
            xhttp.onload = function () {
                if (this.status === 200) {
                    const responseData = JSON.parse(this.responseText);
                    callback(null, responseData);
                } else {
                    const error = new Error(`Error loading data. Status: ${this.status}`);
                    callback(error, null);
                }
            };
            xhttp.open("GET", "withoutChange.json", true);
            xhttp.send();
        }
        loadDoc(function (error, responseData) {
            if (!error) {
                let x = 0;
                var id, dpn, type_0, type_1, type_2, type_3, type_4, type_5, type_6, type_7, type_8, type_9, type_10, lastRealDPN;
                lastRealDPN = '';
                while (x < responseData.length) {
                    id = responseData[x].id;
                    responseData[x].dpn == null ? lastRealDPN = lastRealDPN : lastRealDPN = responseData[x].dpn;
                    responseData[x].dpn != null ? dpn = responseData[x].dpn : dpn = lastRealDPN;
                    type_0 = responseData[x].type_0 == 1 ? `<div onclick="getInfo('${dpn}_CFM4000')"></div>` : "";
                    type_1 = responseData[x].type_1 == 1 ? `<div onclick="getInfo('${dpn}_CFM4100')"></div>` : "";
                    type_2 = responseData[x].type_2 == 1 ? `<div onclick="getInfo('${dpn}_CFM5100')"></div>` : "";
                    type_3 = responseData[x].type_3 == 1 ? `<div onclick="getInfo('${dpn}_CFA711')"></div>` : "";
                    type_4 = responseData[x].type_4 == 1 ? `<div onclick="getInfo('${dpn}_CFA721')"></div>` : "";
                    type_5 = responseData[x].type_5 == 1 ? `<div onclick="getInfo('${dpn}_CFA722')"></div>` : "";
                    type_6 = responseData[x].type_6 == 1 ? `<div onclick="getInfo('${dpn}_711')"></div>` : "";
                    type_7 = responseData[x].type_7 == 1 ? `<div onclick="getInfo('${dpn}_722')"></div>` : "";
                    type_8 = responseData[x].type_8 == 1 ? `<div onclick="getInfo('${dpn}_CC64')"></div>` : "";
                    type_9 = responseData[x].type_9 == 1 ? `<div onclick="getInfo('${dpn}_CC2')"></div>` : "";
                    type_10 = responseData[x].type_10 == 1 ? `<div onclick="getInfo('${dpn}_CC3')"></div>` : "";
                    avoidRepetation(id, dpn, type_0, type_1, type_2, type_3, type_4, type_5, type_6, type_7, type_8, type_9, type_10)
                    x++;
                }
            }
        });
        function filterResult() {
            document.getElementById("dataContainer").innerHTML = "";
            var DPN = document.getElementById("searchBox").value;
            loadDoc(function (error, responseData) {
                if (!error) {
                    let x = 0;
                    var id, dpn, type_0, type_1, type_2, type_3, type_4, type_5, type_6, type_7, type_8, type_9, type_10, lastRealDPN;
                    lastRealDPN = '';
                    var count = 0;
                    while (x < responseData.length) {
                        if (DPN == responseData[x].dpn) {
                            count++;
                            id = responseData[x].id;
                            responseData[x].dpn == null ? lastRealDPN = lastRealDPN : lastRealDPN = responseData[x].dpn;
                            responseData[x].dpn != null ? dpn = responseData[x].dpn : dpn = lastRealDPN;
                            type_0 = responseData[x].type_0 == 1 ? `<div onclick="getInfo('${dpn}_CFM4000')"></div>` : "";
                            type_1 = responseData[x].type_1 == 1 ? `<div onclick="getInfo('${dpn}_CFM4100')"></div>` : "";
                            type_2 = responseData[x].type_2 == 1 ? `<div onclick="getInfo('${dpn}_CFM5100')"></div>` : "";
                            type_3 = responseData[x].type_3 == 1 ? `<div onclick="getInfo('${dpn}_CFA711')"></div>` : "";
                            type_4 = responseData[x].type_4 == 1 ? `<div onclick="getInfo('${dpn}_CFA721')"></div>` : "";
                            type_5 = responseData[x].type_5 == 1 ? `<div onclick="getInfo('${dpn}_CFA722')"></div>` : "";
                            type_6 = responseData[x].type_6 == 1 ? `<div onclick="getInfo('${dpn}_711')"></div>` : "";
                            type_7 = responseData[x].type_7 == 1 ? `<div onclick="getInfo('${dpn}_722')"></div>` : "";
                            type_8 = responseData[x].type_8 == 1 ? `<div onclick="getInfo('${dpn}_CC64')"></div>` : "";
                            type_9 = responseData[x].type_9 == 1 ? `<div onclick="getInfo('${dpn}_CC2')"></div>` : "";
                            type_10 = responseData[x].type_10 == 1 ? `<div onclick="getInfo('${dpn}_CC3')"></div>` : "";
                            avoidRepetation(id, dpn, type_0, type_1, type_2, type_3, type_4, type_5, type_6, type_7, type_8, type_9, type_10)
                        }
                        x++;
                    }
                    if (count === 0) {
                        document.getElementById("dataContainer").innerHTML = `
                            <div class="emptyTable">
                                <img src="./Img/folder_off.svg" alt="folder of">
                                <p>
                                    0 item ?
                                </p>
                            </div>
                            `;
                    }
                }
            });
        }
        function allResult() {
            document.getElementById("dataContainer").innerHTML = "";
            loadDoc(function (error, responseData) {
                if (!error) {
                    let x = 0;
                    var id, dpn, type_0, type_1, type_2, type_3, type_4, type_5, type_6, type_7, type_8, type_9, type_10, lastRealDPN;
                    lastRealDPN = '';
                    while (x < responseData.length) {
                        id = responseData[x].id;
                        responseData[x].dpn == null ? lastRealDPN = lastRealDPN : lastRealDPN = responseData[x].dpn;
                        responseData[x].dpn != null ? dpn = responseData[x].dpn : dpn = lastRealDPN;
                        type_0 = responseData[x].type_0 == 1 ? `<div onclick="getInfo('${dpn}_CFM4000')"></div>` : "";
                        type_1 = responseData[x].type_1 == 1 ? `<div onclick="getInfo('${dpn}_CFM4100')"></div>` : "";
                        type_2 = responseData[x].type_2 == 1 ? `<div onclick="getInfo('${dpn}_CFM5100')"></div>` : "";
                        type_3 = responseData[x].type_3 == 1 ? `<div onclick="getInfo('${dpn}_CFA711')"></div>` : "";
                        type_4 = responseData[x].type_4 == 1 ? `<div onclick="getInfo('${dpn}_CFA721')"></div>` : "";
                        type_5 = responseData[x].type_5 == 1 ? `<div onclick="getInfo('${dpn}_CFA722')"></div>` : "";
                        type_6 = responseData[x].type_6 == 1 ? `<div onclick="getInfo('${dpn}_711')"></div>` : "";
                        type_7 = responseData[x].type_7 == 1 ? `<div onclick="getInfo('${dpn}_722')"></div>` : "";
                        type_8 = responseData[x].type_8 == 1 ? `<div onclick="getInfo('${dpn}_CC64')"></div>` : "";
                        type_9 = responseData[x].type_9 == 1 ? `<div onclick="getInfo('${dpn}_CC2')"></div>` : "";
                        type_10 = responseData[x].type_10 == 1 ? `<div onclick="getInfo('${dpn}_CC3')"></div>` : "";
                        avoidRepetation(id, dpn, type_0, type_1, type_2, type_3, type_4, type_5, type_6, type_7, type_8, type_9, type_10)
                        x++;
                    }
                }
            });
        }

        function getInfo(dpn) {
            document.getElementById("informationWindow").style.display = "block";
            document.getElementById("infoAboutProduct").innerHTML = "";
            loadInfoDoc(function (error, responseData) {
                if (!error) {
                    var matchDPN = [];
                    dpn1 = "DPN_" + dpn + "";
                    matchDPN.push(responseData[dpn1])
                    if (matchDPN.length == 1 && matchDPN[0] == undefined) {
                        let arr = dpn1.split('_');
                        if (arr[2] == 'CFM4000') {
                            dpn2 = arr[0] + '_' + arr[1] + '_CFM4100';
                            matchDPN.push(responseData[dpn2])
                        }
                        else if (arr[2] == 'CFM5100') {
                            dpn2 = arr[0] + '_' + arr[1] + '_CFM5000';
                            dpn3 = arr[0] + '_' + arr[1] + '_CPM5000';
                            dpn4 = arr[0] + '_' + arr[1] + '_CPM5100';
                            dpn5 = arr[0] + '_' + arr[1] + '_OES';
                            matchDPN.push(responseData[dpn2])
                            matchDPN.push(responseData[dpn3])
                            matchDPN.push(responseData[dpn4])
                            matchDPN.push(responseData[dpn5])
                        }
                        else if (arr[2] == 'CFA711') {
                            dpn2 = arr[0] + '_' + arr[1] + '_mci711';
                            dpn3 = arr[0] + '_' + arr[1] + '_MCI711';
                            dpn4 = arr[0] + '_' + arr[1] + '_mci721-722';
                            dpn5 = arr[0] + '_' + arr[1] + '_MCI721-722';
                            dpn6 = arr[0] + '_' + arr[1] + '_CFA711a';
                            dpn7 = arr[0] + '_' + arr[1] + '_CFA711_0.5';
                            dpn8 = arr[0] + '_' + arr[1] + '_CFA711_USCAR21';
                            dpn9 = arr[0] + '_' + arr[1] + '_0.35_CFA711';
                            dpn10 = arr[0] + '_' + arr[1] + '_CFA711_rev';
                            dpn11 = arr[0] + '_' + arr[1] + '_CFA711_rev';
                            dpn12 = arr[0] + '_' + arr[1] + '_mci711_0,13+0,13_2';
                            dpn12 = arr[0] + '_' + arr[1] + '_CC3';
                            dpn13 = arr[0] + '_' + arr[1] + '_CFA711_2';
                            matchDPN.push(responseData[dpn2])
                            matchDPN.push(responseData[dpn3])
                            matchDPN.push(responseData[dpn4])
                            matchDPN.push(responseData[dpn5])
                            matchDPN.push(responseData[dpn6])
                            matchDPN.push(responseData[dpn7])
                            matchDPN.push(responseData[dpn8])
                            matchDPN.push(responseData[dpn9])
                            matchDPN.push(responseData[dpn10])
                            matchDPN.push(responseData[dpn11])
                            matchDPN.push(responseData[dpn12])
                            matchDPN.push(responseData[dpn13])
                        }
                        else if (arr[2] == 'CFA721') {
                            dpn2 = arr[0] + '_' + arr[1] + '_mci721';
                            dpn3 = arr[0] + '_' + arr[1] + '_MCI721';
                            dpn4 = arr[0] + '_' + arr[1] + '_mci721_Double-x';
                            dpn4 = arr[0] + '_' + arr[1] + '_MCI721_Double-x';
                            dpn5 = arr[0] + '_' + arr[1] + '_mci721_Std Crimps';
                            dpn6 = arr[0] + '_' + arr[1] + '_MCI721_Std Crimps';
                            dpn7 = arr[0] + '_' + arr[1] + '_mci721-722';
                            dpn8 = arr[0] + '_' + arr[1] + '_MCI721-722';
                            dpn9 = arr[0] + '_' + arr[1] + '_CFA 722';
                            dpn13 = arr[0] + '_' + arr[1] + '_CFA721_2';
                            matchDPN.push(responseData[dpn2])
                            matchDPN.push(responseData[dpn3])
                            matchDPN.push(responseData[dpn4])
                            matchDPN.push(responseData[dpn5])
                            matchDPN.push(responseData[dpn6])
                            matchDPN.push(responseData[dpn7])
                            matchDPN.push(responseData[dpn8])
                            matchDPN.push(responseData[dpn13])
                        }
                        else if (arr[2] == 'CFA722') {
                            dpn2 = arr[0] + '_' + arr[1] + '-(PE227633)_CFA722+';
                            dpn3 = arr[0] + '_' + arr[1] + '-(PE227634)_CFA722+';
                            dpn4 = arr[0] + '_' + arr[1] + '-(PE230574)_CFA722+';
                            dpn4 = arr[0] + '_' + arr[1] + '-(PE230575)_CFA722+';
                            dpn5 = arr[0] + '_' + arr[1] + '-(PE232028)_CFA722+';
                            dpn6 = arr[0] + '_' + arr[1] + '-(PE230574)_CFA722';
                            matchDPN.push(responseData[dpn2])
                            matchDPN.push(responseData[dpn3])
                            matchDPN.push(responseData[dpn4])
                            matchDPN.push(responseData[dpn5])
                            matchDPN.push(responseData[dpn6])
                        }
                        else if (arr[2] == '711') {
                            dpn2 = arr[0] + '_' + arr[1] + '_CFA711';
                            dpn3 = arr[0] + '_' + arr[1] + '_mci711_0,13+0,13';
                            dpn4 = arr[0] + '_' + arr[1] + '_mci711_0,13+0,13_2';
                            matchDPN.push(responseData[dpn2])
                            matchDPN.push(responseData[dpn3])
                            matchDPN.push(responseData[dpn4])
                        }
                        else if (arr[2] == '722') {
                            dpn2 = arr[0] + '_' + arr[1] + '_0,13_CFA721';
                            dpn3 = arr[0] + '_' + arr[1] + '_Dublex_CFA721';
                            dpn4 = arr[0] + '_' + arr[1] + '_mci721_Double-x';
                            dpn4 = arr[0] + '_' + arr[1] + '_MCI721_Double-x';
                            dpn4 = arr[0] + '_' + arr[1] + '_CFA721_Double-x';
                            dpn5 = arr[0] + '_' + arr[1] + '_Double-x';
                            dpn6 = arr[0] + '_' + arr[1] + '_CFA721';
                            dpn7 = arr[0] + '_' + arr[1] + '_Double-x_CFA721';
                            matchDPN.push(responseData[dpn2])
                            matchDPN.push(responseData[dpn3])
                            matchDPN.push(responseData[dpn4])
                            matchDPN.push(responseData[dpn5])
                            matchDPN.push(responseData[dpn6])
                            matchDPN.push(responseData[dpn7])
                            matchDPN.push(responseData[dpn8])
                            matchDPN.push(responseData[dpn13])
                        }
                    }
                    matchDPN.forEach(element => {
                        if (element != undefined) {
                            element.forEach(subElement => {
                                keys = Object.keys(subElement)
                                if (keys.length == 1) {
                                    document.getElementById("infoAboutProduct").innerHTML += `
                                        <div class="element1">
                                            ${subElement[keys[0]]} &nbsp;
                                        </div>
                                    `
                                }
                                else if (keys.length == 2) {
                                    document.getElementById("infoAboutProduct").innerHTML += `
                                        <div class="element1">
                                            ${subElement[keys[0]]} &nbsp; ${subElement[keys[1]]} &nbsp; 
                                        </div>
                                    `
                                }
                                else if (keys.length == 3) {
                                    document.getElementById("infoAboutProduct").innerHTML += `
                                        <div class="element1">
                                            ${subElement[keys[0]]} &nbsp; ${subElement[keys[1]]} &nbsp; ${subElement[keys[2]]} &nbsp;
                                        </div>
                                    `
                                }
                                else if (keys.length == 4) {
                                    document.getElementById("infoAboutProduct").innerHTML += `
                                        <div class="element1">
                                            ${subElement[keys[0]]} &nbsp; ${subElement[keys[1]]} &nbsp; ${subElement[keys[2]]} &nbsp;${subElement[keys[3]]} &nbsp;
                                        </div>
                                    `
                                }

                            });
                        }
                    });
                }
            });
        }
        function hiddeAnfo() {
            document.getElementById("informationWindow").style.display = 'none';
        }
    </script>

    <img src="./Img/aptivLogo.jfif" class="aptivLogo">
    <p class="title" id="clientsTableTitle">
        Terminals List of Rechecked Monitoring Parameters
    </p>
    <div class="searchBox">
        <input type="text" placeholder="search by DPN" id="searchBox">
        <button class="searchButton" onclick="filterResult()">search</button>
    </div>
    <div class="informationWindow" id="informationWindow">
        <div class="justForSpace" style="height: 20px;">

        </div>
        <div class="backArrowContainer" onclick="hiddeAnfo()">
            <img src="./Img/arrowBack.svg">
        </div>
        <div class="infoAboutProduct" id="infoAboutProduct"></div>
    </div>
    <div class="tableContainer" id="DPNTable">
        <div class="tableHead">
            <div class="cell_1">item</div>
            <div class="cell_2">DPN</div>
            <div class="cell_3">
                OES
                <div class="itemType">
                    <div>
                        CPM 4000
                    </div>
                    <div>
                        CPM 4100
                    </div>
                    <div>
                        CPM 5XXX
                    </div>
                </div>
            </div>
            <div class="cell_4">
                CFA CFA+
                <div class="itemType">
                    <div>
                        721
                    </div>
                    <div>
                        721/1 C3170
                    </div>
                    <div>
                        721/1 C3170
                    </div>
                </div>
            </div>
            <div class="cell_5">
                DOUBLE x
                <div class="itemType">
                    <div>
                        721
                    </div>
                    <div>
                        721/1 C3170
                    </div>
                </div>
            </div>
            <div class="cell_6">
                SLE
                <div class="itemType">
                    <div>
                        SLE
                    </div>
                </div>
            </div>
            <div class="cell_7">
                KISTLER
                <div class="itemType">
                    <div>
                        CC2
                    </div>
                    <div>
                        CC3
                    </div>
                </div>
            </div>
        </div>
        <div id="dataContainer">
        </div>
        <div class="allResult" onclick="allResult()" >
            see all
        </div>
    </div>
</body>

</html>